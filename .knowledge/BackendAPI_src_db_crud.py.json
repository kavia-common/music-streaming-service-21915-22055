{"is_source_file": true, "format": "Python", "description": "This file provides data access and CRUD (Create, Read, Update, Delete) helper functions for a music streaming service backend, including user authentication, playlist management, and catalog search functionalities.", "external_files": ["src/core/security", "src/db/models", "src.schemas.users"], "external_methods": ["hash_password", "verify_password", "create_access_token"], "published": ["get_user_by_email", "create_user", "authenticate_user", "update_user_profile", "list_user_playlists", "create_playlist", "get_playlist", "update_playlist", "delete_playlist", "list_playlist_tracks", "add_track_to_playlist", "remove_track_from_playlist", "search_catalog"], "classes": [], "methods": [{"name": "Optional[User] get_user_by_email(db: Session, email: str)", "description": "Retrieves a user by email, case-insensitive.", "scope": "", "scopeKind": ""}, {"name": "Tuple[Optional[User],Optional[str]] create_user(db: Session, data: UserCreate)", "description": "Registers a new user, handling duplicate email errors.", "scope": "", "scopeKind": ""}, {"name": "Tuple[Optional[str],Optional[User],Optional[str]] authenticate_user(db: Session, credentials: UserLogin)", "description": "Authenticates user credentials and generates a JWT token.", "scope": "", "scopeKind": ""}, {"name": "Optional[User] update_user_profile(db: Session, user_id: int, updates: UserUpdate)", "description": "Updates user profile fields.", "scope": "", "scopeKind": ""}, {"name": "List[Playlist] list_user_playlists(db: Session, owner_user_id: int)", "description": "Lists all playlists belonging to a specific user.", "scope": "", "scopeKind": ""}, {"name": "Tuple[Optional[Playlist],Optional[str]] create_playlist( db: Session, owner_user_id: int, name: str, description: Optional[str] = None, cover_image: Optional[str] = None, is_public: bool = False )", "description": "Creates a new playlist for a user.", "scope": "", "scopeKind": ""}, {"name": "Optional[Playlist] get_playlist(db: Session, playlist_id: int, owner_user_id: Optional[int] = None)", "description": "Fetches a playlist by ID, optionally restricting to owner.", "scope": "", "scopeKind": ""}, {"name": "Optional[Playlist] update_playlist( db: Session, playlist_id: int, owner_user_id: int, name: Optional[str] = None, description: Optional[str] = None, cover_image: Optional[str] = None, is_public: Optional[bool] = None )", "description": "Updates playlist details.", "scope": "", "scopeKind": ""}, {"name": "bool delete_playlist(db: Session, playlist_id: int, owner_user_id: int)", "description": "Deletes a playlist identified by ID for the user.", "scope": "", "scopeKind": ""}, {"name": "List[PlaylistTrack] list_playlist_tracks(db: Session, playlist_id: int)", "description": "Lists all tracks in a playlist ordered by position.", "scope": "", "scopeKind": ""}, {"name": "Tuple[Optional[PlaylistTrack],Optional[str]] add_track_to_playlist(db: Session, playlist_id: int, track_id: int, position: Optional[int] = None)", "description": "Adds a track to a playlist at a specified or next available position.", "scope": "", "scopeKind": ""}, {"name": "bool remove_track_from_playlist(db: Session, playlist_id: int, track_id: int)", "description": "Removes a track from a playlist.", "scope": "", "scopeKind": ""}, {"name": "dict[str,list[Any]] search_catalog( db: Session, query: str, genre: Optional[str] = None, artist: Optional[str] = None, album: Optional[str] = None, limit: int = 25, offset: int = 0 )", "description": "Performs a search over tracks, artists, and albums with optional filters.", "scope": "", "scopeKind": ""}], "calls": ["select", "update", "delete", "insert", "func.lower", "func.coalesce", "db.execute", "db.commit", "db.refresh", "db.rollback"], "search-terms": ["SQLAlchemy CRUD functions", "playlist management", "user authentication", "music catalog search", "PlaylistTrack", "src.db.models", "hash_password"], "state": 2, "file_id": 10, "knowledge_revision": 36, "git_revision": "", "revision_history": [{"22": ""}, {"36": ""}], "ctags": [{"_type": "tag", "name": "add_track_to_playlist", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/db/crud.py", "pattern": "/^def add_track_to_playlist(db: Session, playlist_id: int, track_id: int, position: Optional[int] /", "language": "Python", "typeref": "typename:Tuple[Optional[PlaylistTrack],Optional[str]]", "kind": "function", "signature": "(db: Session, playlist_id: int, track_id: int, position: Optional[int] = None)"}, {"_type": "tag", "name": "authenticate_user", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/db/crud.py", "pattern": "/^def authenticate_user(db: Session, credentials: UserLogin) -> Tuple[Optional[str], Optional[User/", "language": "Python", "typeref": "typename:Tuple[Optional[str],Optional[User],Optional[str]]", "kind": "function", "signature": "(db: Session, credentials: UserLogin)"}, {"_type": "tag", "name": "create_playlist", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/db/crud.py", "pattern": "/^def create_playlist($/", "language": "Python", "typeref": "typename:Tuple[Optional[Playlist],Optional[str]]", "kind": "function", "signature": "( db: Session, owner_user_id: int, name: str, description: Optional[str] = None, cover_image: Optional[str] = None, is_public: bool = False )"}, {"_type": "tag", "name": "create_user", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/db/crud.py", "pattern": "/^def create_user(db: Session, data: UserCreate) -> Tuple[Optional[User], Optional[str]]:$/", "language": "Python", "typeref": "typename:Tuple[Optional[User],Optional[str]]", "kind": "function", "signature": "(db: Session, data: UserCreate)"}, {"_type": "tag", "name": "delete_playlist", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/db/crud.py", "pattern": "/^def delete_playlist(db: Session, playlist_id: int, owner_user_id: int) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(db: Session, playlist_id: int, owner_user_id: int)"}, {"_type": "tag", "name": "get_playlist", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/db/crud.py", "pattern": "/^def get_playlist(db: Session, playlist_id: int, owner_user_id: Optional[int] = None) -> Optional/", "language": "Python", "typeref": "typename:Optional[Playlist]", "kind": "function", "signature": "(db: Session, playlist_id: int, owner_user_id: Optional[int] = None)"}, {"_type": "tag", "name": "get_user_by_email", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/db/crud.py", "pattern": "/^def get_user_by_email(db: Session, email: str) -> Optional[User]:$/", "language": "Python", "typeref": "typename:Optional[User]", "kind": "function", "signature": "(db: Session, email: str)"}, {"_type": "tag", "name": "list_playlist_tracks", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/db/crud.py", "pattern": "/^def list_playlist_tracks(db: Session, playlist_id: int) -> List[PlaylistTrack]:$/", "language": "Python", "typeref": "typename:List[PlaylistTrack]", "kind": "function", "signature": "(db: Session, playlist_id: int)"}, {"_type": "tag", "name": "list_user_playlists", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/db/crud.py", "pattern": "/^def list_user_playlists(db: Session, owner_user_id: int) -> List[Playlist]:$/", "language": "Python", "typeref": "typename:List[Playlist]", "kind": "function", "signature": "(db: Session, owner_user_id: int)"}, {"_type": "tag", "name": "remove_track_from_playlist", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/db/crud.py", "pattern": "/^def remove_track_from_playlist(db: Session, playlist_id: int, track_id: int) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(db: Session, playlist_id: int, track_id: int)"}, {"_type": "tag", "name": "search_catalog", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/db/crud.py", "pattern": "/^def search_catalog($/", "language": "Python", "typeref": "typename:dict[str,list[Any]]", "kind": "function", "signature": "( db: Session, query: str, genre: Optional[str] = None, artist: Optional[str] = None, album: Optional[str] = None, limit: int = 25, offset: int = 0 )"}, {"_type": "tag", "name": "update_playlist", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/db/crud.py", "pattern": "/^def update_playlist($/", "language": "Python", "typeref": "typename:Optional[Playlist]", "kind": "function", "signature": "( db: Session, playlist_id: int, owner_user_id: int, name: Optional[str] = None, description: Optional[str] = None, cover_image: Optional[str] = None, is_public: Optional[bool] = None )"}, {"_type": "tag", "name": "update_user_profile", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/db/crud.py", "pattern": "/^def update_user_profile(db: Session, user_id: int, updates: UserUpdate) -> Optional[User]:$/", "language": "Python", "typeref": "typename:Optional[User]", "kind": "function", "signature": "(db: Session, user_id: int, updates: UserUpdate)"}], "hash": "46dc967b4a34992207d300e0f301f62b", "format-version": 4, "code-base-name": "BackendAPI", "filename": "BackendAPI/src/db/crud.py"}