{"is_source_file": true, "format": "Python", "description": "Source code for backend admin API routes in a music streaming service, handling user listing and track creation with auditing.", "external_files": ["src.api.deps", "src.db.models", "src.schemas.catalog", "src.schemas.users", "fastapi", "sqlalchemy"], "external_methods": ["get_current_admin", "get_db", "select", "AdminAuditLog", "Track", "User", "UserOut.model_validate", "TrackCreate", "TrackOut"], "published": ["router", "_audit", "list_users_admin", "create_music_admin"], "classes": [{"name": "AdminAuditLog", "description": "Model representing audit logs for admin actions."}, {"name": "Track", "description": "Model representing a music track."}, {"name": "User", "description": "Model representing a user."}], "methods": [{"name": "None _audit( db: Session, admin_user_id: int, action: str, target_type: Optional[str] = None, target_id: Optional[str] = None, details: Optional[dict] = None, )", "description": "Inserts an audit log entry for admin actions, swallowing errors to avoid affecting main flow.", "scope": "", "scopeKind": ""}, {"name": "List[UserOut] list_users_admin( db: Session = Depends(get_db), current_admin: User = Depends(get_current_admin), page: int = Query(1, ge=1, description=\"Page number (1-indexed)\"), limit: int = Query(25, ge=1, le=100, description=\"Items per page\"), )", "description": "API endpoint to retrieve a paginated list of users, with audit logging.", "scope": "", "scopeKind": ""}, {"name": "Tuple[Optional[Track],Optional[str]] _create_track( db: Session, payload: TrackCreate )", "description": "Creates a new track record in the database, returns track or error message.", "scope": "", "scopeKind": ""}, {"name": "TrackOut create_music_admin( payload: TrackCreate, db: Session = Depends(get_db), current_admin: User = Depends(get_current_admin), )", "description": "API endpoint to create a new music track with audit logging.", "scope": "", "scopeKind": ""}], "calls": ["db.execute", "db.add", "db.commit", "db.refresh", "db.rollback", "select", "AdminAuditLog", "Track", "User", "UserOut.model_validate", "TrackOut.model_validate"], "search-terms": ["admin routes", "audit logging", "paginated user list", "create track API", "admin-only endpoints"], "state": 2, "file_id": 27, "knowledge_revision": 70, "git_revision": "bd18e8f1ba36a3b3c0f5feac3d420d7c429b6505", "revision_history": [{"68": "bd18e8f1ba36a3b3c0f5feac3d420d7c429b6505"}, {"70": "bd18e8f1ba36a3b3c0f5feac3d420d7c429b6505"}], "ctags": [{"_type": "tag", "name": "_audit", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/api/routes/admin.py", "pattern": "/^def _audit($/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "( db: Session, admin_user_id: int, action: str, target_type: Optional[str] = None, target_id: Optional[str] = None, details: Optional[dict] = None, )"}, {"_type": "tag", "name": "_create_track", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/api/routes/admin.py", "pattern": "/^def _create_track($/", "language": "Python", "typeref": "typename:Tuple[Optional[Track],Optional[str]]", "kind": "function", "signature": "( db: Session, payload: TrackCreate )"}, {"_type": "tag", "name": "create_music_admin", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/api/routes/admin.py", "pattern": "/^def create_music_admin($/", "language": "Python", "typeref": "typename:TrackOut", "kind": "function", "signature": "( payload: TrackCreate, db: Session = Depends(get_db), current_admin: User = Depends(get_current_admin), )"}, {"_type": "tag", "name": "list_users_admin", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/api/routes/admin.py", "pattern": "/^def list_users_admin($/", "language": "Python", "typeref": "typename:List[UserOut]", "kind": "function", "signature": "( db: Session = Depends(get_db), current_admin: User = Depends(get_current_admin), page: int = Query(1, ge=1, description=\"Page number (1-indexed)\"), limit: int = Query(25, ge=1, le=100, description=\"Items per page\"), )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/api/routes/admin.py", "pattern": "/^router = APIRouter(prefix=\"\\/admin\", tags=[\"Admin\"])$/", "language": "Python", "kind": "variable"}], "hash": "802a84193c4e43d5363001262cca3600", "format-version": 4, "code-base-name": "BackendAPI", "filename": "BackendAPI/src/api/routes/admin.py", "fields": [{"name": "router = APIRouter(prefix=\"\\/admin\", tags=[\"Admin\"])", "scope": "", "scopeKind": "", "description": "unavailable"}]}