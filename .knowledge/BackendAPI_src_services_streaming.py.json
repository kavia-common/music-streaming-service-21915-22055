{"is_source_file": true, "format": "Python", "description": "This source file provides a streaming service module for the BackendAPI, including functions to start and stop a streaming session, manage playback history, and validate track existence and URL availability.", "external_files": ["src/db/models.py"], "external_methods": ["sqlalchemy.select", "sqlalchemy.orm.Session"], "published": ["start_streaming_session", "stop_streaming_session", "StreamSession"], "classes": [{"name": "StreamSession", "description": "Lightweight representation of a streaming session returned to the client, including user ID, track ID, stream URL, and start time."}], "methods": [{"name": "datetime _now_utc()", "description": "Returns the current UTC datetime.", "scope": "", "scopeKind": ""}, {"name": "Tuple[Optional[StreamSession],Optional[str]] start_streaming_session(db: Session, user_id: int, track_id: int)", "description": "Starts a streaming session by validating the track, recording a start event, and returning session info.", "scope": "", "scopeKind": ""}, {"name": "Tuple[bool,Optional[str]] stop_streaming_session( db: Session, user_id: int, track_id: int, played_seconds: Optional[int] = None, )", "description": "Stops a streaming session by recording a stop event with the played duration.", "scope": "", "scopeKind": ""}], "calls": ["select(Track).where(Track.id == track_id)", "db.execute", "db.add", "db.commit", "db.rollback"], "search-terms": ["streaming.py", "PlaybackHistory", "Track", "start_streaming_session", "stop_streaming_session", "session management", "audio_url validation"], "state": 2, "file_id": 24, "knowledge_revision": 61, "git_revision": "", "ctags": [{"_type": "tag", "name": "StreamSession", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/services/streaming.py", "pattern": "/^class StreamSession:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_now_utc", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/services/streaming.py", "pattern": "/^def _now_utc() -> datetime:$/", "language": "Python", "typeref": "typename:datetime", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "start_streaming_session", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/services/streaming.py", "pattern": "/^def start_streaming_session(db: Session, user_id: int, track_id: int) -> Tuple[Optional[StreamSe/", "language": "Python", "typeref": "typename:Tuple[Optional[StreamSession],Optional[str]]", "kind": "function", "signature": "(db: Session, user_id: int, track_id: int)"}, {"_type": "tag", "name": "stop_streaming_session", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22055/BackendAPI/src/services/streaming.py", "pattern": "/^def stop_streaming_session($/", "language": "Python", "typeref": "typename:Tuple[bool,Optional[str]]", "kind": "function", "signature": "( db: Session, user_id: int, track_id: int, played_seconds: Optional[int] = None, )"}], "hash": "5b18218424f916fe0b6c2231d05faf75", "format-version": 4, "code-base-name": "BackendAPI", "filename": "BackendAPI/src/services/streaming.py", "revision_history": [{"61": ""}]}